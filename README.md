# Solving-SQL-Interview-Questions

Single-Table Operations (Q1–Q35):
- 1. Top store for movie sales
- 2. Top 3 movie categories by sales
- 3. Top 5 shortest movies
4. Staff without a profile image
5. Monthly revenue
6. Daily revenue in June 2020
7. Unique customers count by month
8. Average customer spend by month
9. Number of high‑spend customers by month
10. Min and max spend
11. Actors’ last name
12. Actors’ last name ending in ‘EN’ or ‘RY’
13. Actors’ first name
14. Good days and bad days
15. Fast movie watchers vs. slow watchers
16. Staff who live in Woodridge
17. GROUCHO WILLIAMS’ actor_id
18. Top film category
19. Most productive actor
20. Customer who spent the most (Feb 2020)
21. Customer who rented the most (May 2020)
22. Average cost per rental transaction (May 2020)
23. Average spend per customer (Feb 2020)
24. Films with ≥ 10 actors
25. Shortest film
26. Second shortest film
27. Film with the largest cast
28. Film with the second largest cast
29. Second highest‑spend customer
30. Inactive customers in May 2020
31. Movies that have not been returned
32. Unpopular movies (no rentals in Feb 2020)
33. Returning customers in May and June 2020
34. Stocked‑up movies (> 7 copies in inventory)
35. Film length report (short/medium/long)

Search‑Table Operations (Q81–Q86, Q89):
81. How many people searched on New Year’s Day 2021-01-01?
82. The top search query on New Year’s Day
84. Click‑through rate on New Year’s Day
85. Top 5 queries by click‑through rate on New Year’s Day
86. Top song in the US (yesterday)
89. Top 5 artists in the US (yesterday)

Multi‑Table Operations (Q36–Q50, Q51–Q57, Q87):
36. Actors from film ‘AFRICAN EGG’
37. Most popular movie category (id)
38. Most popular movie category (id + name)
39. Most productive actor (INNER JOIN)
40. Top 5 most rented movies in June 2020
41. Productive vs. less‑productive actors
42. Films in stock vs. not in stock
43. Customers who rented vs. never rented (May 2020)
44. In‑demand vs. not‑in‑demand movies (May 2020)
45. Movie inventory optimization (remove zero‑demand titles)
46. Actors & customers whose last name starts with ‘A’
47. Actors & customers whose first name ends in ‘D’
48. Actors in both TV and movies (INNER JOIN)
49. Top 3 money‑making movie categories (rental revenue)
50. Top 5 cities by rental revenue (2020)
51. Actors who appear only in movies
52. Film IDs whose entire cast are movie‑only actors
53. Movie groups by rental‑income band (high/medium/low)
54. Customer spend groups (high/medium/low)
55. Busy vs. slow days (rental counts, May 2020)
56. Total number of actors (FULL OUTER JOIN)
57. Total number of actors (UNION)
87. Top song in US & UK (yesterday)

Window Functions (Q58–Q61, Q62–Q80, Q83, Q88, Q90):
58. Percentage of revenue per movie (film_id ≤ 10)
59. Percentage of revenue per movie by category (film_id ≤ 10)
60. Movie rentals and avg. rentals in the same category (film_id ≤ 10)
61. Customer LTV vs. avg. LTV in the same store
62. Shortest film by category
63. Top 5 customers by store (by spend)
64. Top 2 films by category (by rental revenue)
65. Movie revenue percentiles (film_id IN 1,10,11,20,21,30)
66. Movie percentiles by revenue by category (film_id ≤ 20)
67. Quartiles by number of rentals (film_id IN 1,10,11,20,21,30)
68. Spend difference between first and second rentals (cust_id 1–10)
69. Number of happy customers (May 24–31)
70. Cumulative spend per day (cust_id 1–3)
71. Cumulative rentals per day (cust_id 3–5)
72. Dates when cust_id 1–10 became ‘happy’ (10th rental)
73. Days to become a happy customer (avg days to 10th rental)
74. Most productive actor per category
75. Top customer by movie category (highest spend)
76. Districts with the most and least customers
77. Revenue percentiles by category (film_id IN 1–5)
78. Quartiles by rentals per customer (cust_id 1–10)
79. Spend difference between last and second‑last rentals (cust_id 1–10)
80. Day‑over‑day revenue growth per store (May 24–31)
83. Top search query in US & UK on New Year’s Day
88. Top song report: top song_id per country
90. Top artist report: top artist_id per country


